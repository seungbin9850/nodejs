# node.js

## node.js?

node js란 크롬 V8 자바스크립트 엔진으로 빌드된 자바스크립트 런타임

node js는 **single thread** 기반으로 동작함

node js는 **이벤트 기반, 논블로킹 I/O** 모델을 사용해 가볍고 효율적임

## V8 Engine

웹 브라우저를 만드는 데 기반을 제공하는 오픈 소스 자바스크립트 엔진

node js는 크롬 V8엔진으로 개발되어 있음

node js는 V8과 더불어 libuv라는 라이브러리를 사용함

libuv 라이브러리는 node js의 특성인 이벤트 기반, 논블로킹 I/O 모델을 구현하고 있음


## Event Driven

이벤트 기반(Event Driven) : 이벤트(클릭, 네트워크 요청 등)가 발생할 때 미리 지정해 둔 작업을 수행하는 방식

이벤트 기반 시스템에서는 특정 이벤트가 발생할 때 무엇을 할 지 미리 등록해 두어야 함 => 이벤트 리스너에 콜백 함수를 등록한다

이벤트 기반 모델에서는 이벤트 루프라는 개념이 등장함

## Event Loop

이벤트 루프 : 이벤트 발생 시 호출할 콜백 함수들을 관리하고, 호출된 콜백 함수의 실행 순서를 결정하는 역할을 담당함

태스크 큐 (이벤트 큐) : 이벤트 발생 후 호출되어야 할 콜백 함수들이 기다리는 공간

백그라운드 : 타이머나 I/O 작업 콜백 또는 이벤트 리스너들이 대기하는 곳

Call Stack이 비었을 때 태스크 큐에 작업이 있다면 그 작업을 실행함

이벤트 루프를 잘 활용하면 오래 걸리는 작업을 효율적으로 처리할 수 있음.

1. 오래 걸리는 함수를 백그라운드로 보냄

2. 다음 코드가 먼저 실행되게 함

3. 그 함수가 다시 태스크 큐를 거쳐 호출 스택으로 올라오기를 기다림

## Non-blocking I/O

논 블로킹 : 이전 작업이 완료될 때 까지 멈추지 않고 다음 작업을 수행함

블로킹 방식보다 논 블로킹 방식이 같은 작업을 더 짧은 시간 동안 처리할 수 있음

## Single Thread

node js는 싱글 스레드이므로 주어진 작업을 혼자서 처리해야 함

한 번에 한 가지 일밖에 처리하지 못하므로, 어떠한 작업에서 블로킹이 발생하면 다음 일을 처리하지 못함

사실 노드 프로세스도 내부적으론 스레드를 여러 개 가지고 있지만, 직접 제어할 수 있는 스레드가 하나 뿐이라 싱글 스레드라고 부름

## 장점

1. 멀티 스레드 방식에 비해 컴퓨터 자원을 적게 사용함

2. 웹 서버가 내장되어 있음
    - 내장 http 서버 라이브러리를 포함하고 있어 웹 서버에서 아파치 등 별도의 소프트웨어 설치 없이 동작이 가능함

3. 생산성이 빠름

4. Non blocking I/O, 싱글 스레드, 이벤트 루프를 통한 높은 처리 성능

5. npm을 통해 여러가지 라이브러리를 제공받을 수 있음

## 단점

1. 싱글 스레드이기에 하나의 작업 자체가 많이 걸리는 서비스에는 부적합

2. 에러가 발생할 경우 프로세스 자체가 죽어버림
